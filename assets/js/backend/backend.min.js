"use strict";jQuery(document).ready(function(a){var o,n,d,i,l,c,m,v;a(document).on("click",".svea-credit-items",function(e){var s,t=a(".woocommerce_order_items tr[data-order_item_id] .check-column input[type='checkbox']:checked");0===t.length?alert(Phrases.not_selected_any_items):(s=[],t.each(function(){s.push(a(this).parents("tr[data-order_item_id]").data("order_item_id"))}),confirm(Phrases.confirm_credit_items.replace(/%d/g,s.length))&&(window.location.href=Svea.adminCreditUrl+s.join(",")))}),a(document).on("click",".svea-deliver-items",function(e){var s,t=a(".woocommerce_order_items tr[data-order_item_id] .check-column input[type='checkbox']:checked");0===t.length?alert(Phrases.not_selected_any_items):(s=[],t.each(function(){s.push(a(this).parents("tr[data-order_item_id]").data("order_item_id"))}),confirm(Phrases.confirm_deliver_items.replace(/%d/g,s.length))&&(window.location.href=Svea.adminDeliverUrl+s.join(",")))}),a("body").hasClass("post-type-shop_subscription")&&(n=!(o=[]),d="sveawebpay_invoice",i="sveawebpay_part_pay",l=a('.woocommerce select[name="_billing_country"]').val().toLowerCase(),c=a('.woocommerce select[name="_payment_method"]').val(),m=a('.woocommerce select[name="_iv_billing_customer_type"]').val().toLowerCase(),void 0!==(l=0!=Svea.onlyOneAllowedCountry?Svea.onlyOneAllowedCountry.toLowerCase():l)&&0!=l&&0<l.length&&a(".svea-fields").addClass("country-"+l),void 0!==c&&0!=c&&0<c.length&&a(".svea-fields").addClass("payment-method-"+c),void 0!==m&&0!=m&&0<m.length&&a(".svea-fields").addClass("customer-type-"+m),v=function(e){0<String(e.firstName).length&&a("#_billing_first_name").val(String(e.firstName)),0<String(e.lastName).length&&a("#_billing_last_name").val(String(e.lastName)),"business"==String(e.customerType).toLowerCase()&&a("#_billing_company").val(String(e.fullName)),0<String(e.street).length&&a("#_billing_address_1").val(String(e.street)),0<String(e.coAddress).length&&a("#_billing_address_2").val(String(e.coAddress)),0<String(e.zipCode).length&&a("#_billing_postcode").val(String(e.zipCode)),0<String(e.locality).length&&a("#_billing_city").val(String(e.locality)),0<String(e.phoneNumber).length&&a("#_billing_phone").val(String(e.phoneNumber))},a(document).on("click",".svea-get-address-button",function(e){var s,t=a(this).parents(".svea-fields-admin"),r=t.find(".svea-get-address-button-container");e.preventDefault(),n||("individual"==m||c==i?(s=c==d?"iv":"pp",e=t.find("input[name='_"+s+"_billing_ssn']").val(),t.addClass("getting-address"),n=!0,a.post(Svea.ajaxUrl,{action:"svea_get_address",pers_nr:e,country_code:l,payment_type:c,security:Svea.gaSecurity},function(e){t.removeClass("getting-address"),n=!1,void 0===e.resultcode||void 0===e.customerIdentity?(r.after('<div class="svea-message error">'+Phrases.could_not_get_address+"</div>"),t.addClass("getting-address-error"),setTimeout(function(){t.find(".svea-message.error").remove(),t.removeClass("getting-address-error")},5e3)):"Error"==e.resultcode||"NoSuchEntity"==e.resultcode?(r.after('<div class="svea-message error">'+e.errormessage+"</div>"),t.addClass("getting-address-error"),setTimeout(function(){t.find(".svea-message.error").remove(),t.removeClass("getting-address-error")},5e3)):(e=e.customerIdentity[0],v(e),r.after('<div class="svea-message success">'+Phrases.your_address_was_found+"</div>"),t.addClass("getting-address-success"),setTimeout(function(){t.find(".svea-message.success").remove(),t.removeClass("getting-address-success")},5e3))})):"company"==m&&(s=c==d?"iv":"pp",e=t.find("input[name='_"+s+"_billing_org_number']").val(),t.addClass("getting-address"),n=!0,a.post(Svea.ajaxUrl,{action:"svea_get_address",org_nr:e,country_code:l,payment_type:c,security:Svea.gaSecurity},function(e){t.removeClass("getting-address"),n=!1,void 0===e.resultcode||void 0===e.customerIdentity?(r.after('<div class="svea-message error">'+Phrases.could_not_get_address+"</div>"),t.addClass("getting-address-error"),setTimeout(function(){t.find(".svea-message.error").remove(),t.removeClass("getting-address-error")},5e3)):"Error"==e.resultcode||"NoSuchEntity"==e.resultcode?(r.after('<div class="svea-message error">'+e.errormessage+"</div>"),t.addClass("getting-address-error"),setTimeout(function(){t.find(".svea-message.error").remove(),t.removeClass("getting-address-error")},5e3)):(e=e.customerIdentity,a(".org-address-selector").html(function(e){if(e.length<=0)return"";for(var s="",t=0;t<e.length;++t){var r=e[t];s+='<option value="'+r.addressSelector+'">',"business"==r.customerType.toLowerCase()?s+=r.fullName+", ":"person"==r.customerType.toLowerCase()&&(s+=r.lastName+", "+r.firstName+" "),s+=r.street+" "+r.zipCode+" "+r.locality+"</option>"}return s}(e)),o=e,a(".address-selector").val(e[0].addressSelector),v(e[0]),t.addClass("getting-address-success"),r.after('<div class="svea-message success">'+Phrases.your_address_was_found+"</div>"),setTimeout(function(){t.find(".svea-message.success").remove(),t.removeClass("getting-address-success")},5e3))})))}),a(document).on("change",".org-address-selector",function(){for(var e=0;e<o.length;++e){var s=o[e];if(s.addressSelector==a(".org-address-selector").val())return a(".address-selector").val(a(".org-address-selector").val()),v(s),void 0}}),a(document).on("click",".woocommerce a.edit_address",function(e){a(".svea-fields").addClass("edit-opened")}),a(document).on("change",'.woocommerce select[name="_billing_country"]',function(e){a(".svea-fields").removeClass("country-"+l),l=a(this).val().toLowerCase(),a(".svea-fields").addClass("country-"+l)}),a(document).on("change",'.woocommerce select[name="_payment_method"]',function(e){a(".svea-fields").removeClass("payment-method-"+c),c=a(this).val(),a(".svea-fields").addClass("payment-method-"+c)}),a(document).on("change",'.woocommerce select[name="_iv_billing_customer_type"]',function(e){a(".svea-fields").removeClass("customer-type-"+m),m=a(this).val(),a(".svea-fields").addClass("customer-type-"+m)}))});